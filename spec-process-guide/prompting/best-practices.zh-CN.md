# 提示最佳实践

<!-- 导航元数据 -->
<!-- 提示：最佳实践 | 级别：实践指南 | 先决条件：prompting/strategies.md -->
<!-- 相关：ai-reasoning/decision-frameworks.md, examples/troubleshooting-pitfalls.md, templates/README.md -->

**📍 您在这里：** [主指南](../../README.md) → [提示策略](README.md) → **最佳实践**

## 快速导航
- **📚 学习策略：** [提示策略](strategies.md) - 首先掌握核心方法
- **📝 使用模板：** [提示模板](templates.md) - 即用即得的模式
- **🧠 理解 AI：** [决策框架](../ai-reasoning/decision-frameworks.md) - AI 如何做出选择
- **🔧 解决问题：** [故障排除指南](../examples/troubleshooting-pitfalls.md) - 当提示出错时

---

在规范创建过程中与 AI 协作的有效技术，包括故障排除指南和成功交互的示例。

## 核心原则

### 1. 上下文为王

**提供丰富的上下文**
- 始终包含有关您的项目、技术栈和约束的相关背景信息
- 引用之前的讨论和决策以保持连续性
- 解释您的需求背后的“为什么”，而不仅仅是“什么”

**示例 - 良好的上下文设置：**
```
我正在开发一个 React 电子商务应用程序，目前每天处理 1 万用户。
我们使用 TypeScript、Node.js 后端和 PostgreSQL，并部署在 AWS 上。
我需要添加一个产品推荐功能，该功能需要与我们现有的
用户行为跟踪系统集成，并应能处理我们预期的 50% 流量增长。
```

**示例 - 糟糕的上下文：**
```
我需要一个推荐系统。
```

### 2. 具体和明确

**使用具体示例**
- 提供具体场景，而不是抽象描述
- 在讨论数据模型时包含实际数据示例
- 引用真实的用户工作流和业务流程

**示例 - 具体请求：**
```
对于用户认证系统，我需要处理以下具体场景：
1. 使用电子邮件验证的新用户注册
2. 通过 Google 和 GitHub OAuth 进行社交登录
3. 具有安全令牌过期（24 小时）的密码重置
4. 5 次失败尝试后账户锁定，冷却时间为 30 分钟
5. 与我们存储偏好的现有用户个人资料系统集成
```

### 3. 结构化复杂请求

**分解大型请求**
- 将复杂功能划分为逻辑阶段
- 优先考虑核心功能，而不是“锦上添花”的功能
- 按顺序提出请求以逐步建立理解

**示例 - 结构良好的请求：**
```
我想为文件上传系统创建一个全面的规范。让我们从以下开始：

阶段 1：核心上传功能
- 带进度跟踪的单文件上传
- 文件类型验证（图片、文档）
- 大小限制（最大 10MB）

阶段 2：增强功能（在阶段 1 稳固后再处理）
- 多文件上传
- 拖放界面
- 云存储集成
```

## 各阶段最佳实践

### 需求阶段

**应该做：**
- 从用户问题开始，而不是技术解决方案
- 一致地使用“作为 [角色]，我想要 [目标]，以便 [收益]”的格式
- 包括正常路径和错误场景
- 指定可衡量的验收标准

**不应该做：**
- 直接跳到实现细节
- 假设 AI 了解您的业务背景
- 创建过于宽泛或模糊的需求
- 跳过边缘情况和错误处理

**成功交互示例：**
```
用户：“我需要为我的应用提供用户认证。”

更好的方法：“我正在为小企业构建一个 SaaS 应用程序。
我需要支持以下功能的用户认证：
- 需要管理团队访问权限的企业主
- 具有不同权限级别的团队成员
- 与现有客户数据集成
- 符合 SOC 2 要求

主要用户故事是：作为企业主，我想要控制谁可以
访问我们公司的敏感数据，以便我能维护安全和合规性。”
```

### 设计阶段

**应该做：**
- 在做设计决策时引用具体需求
- 解释不同方法之间的权衡
- 从一开始就考虑可伸缩性和可维护性
- 在设计中包括错误处理和边缘情况

**不应该做：**
- 脱离需求进行设计
- 为假设的未来需求过度设计
- 忽略现有系统约束
- 跳过非功能性需求

**成功交互示例：**
```
用户：“根据我们的认证需求，我需要一个能够处理我们讨论过的多租户访问控制的设计。我们当前的系统使用 JWT 令牌，我们大约有 500 家企业，平均每家有 8 名团队成员。性能至关重要——登录时间应低于 200 毫秒。

请设计一个方法，该方法：
1. 利用我们现有的 JWT 基础设施
2. 能够扩展到我们当前的用户群
3. 支持需求 2.3 中的基于角色的权限
4. 与我们的 PostgreSQL 用户数据库集成”
```

### 任务阶段

**应该做：**
- 请求可增量构建的任务
- 为每个任务指定测试要求
- 要求可以独立完成的任务
- 包括集成和部署考虑

**不应该做：**
- 创建过于庞大或复杂的任务
- 跳过测试和验证步骤
- 忽略任务之间的依赖关系
- 忘记文档和清理工作

**成功交互示例：**
```
用户：“请将认证设计分解为编码任务。
我想遵循 TDD 原则，并能够增量部署。
每个任务应能在 2-4 小时内完成，并包含其自身的测试。

优先事项是首先实现基本的登录/注销功能，然后再添加
基于角色的权限。我正在使用 Jest 进行测试，并已使用 GitHub Actions 设置了 CI/CD。”
```

## 沟通技巧

### 迭代求精

**在先前回应的基础上构建**
```
“总体需求看起来不错。我想对需求 2.1 进行更具体的说明，以明确错误处理。与其说‘系统应优雅地处理错误’，不如让我们具体说明当认证失败、网络不可用和令牌过期时会发生什么。”
```

**验证理解**
```
“在我们进入设计阶段之前，让我确认一下我的理解：
- 我们优先考虑安全性而非便利性
- 与现有系统的集成是强制性的，而非可选的
- 性能要求是确定的（登录时间低于 200 毫秒）
- 我们需要支持 Web 和移动客户端
这是否正确？”
```

### 反馈整合

**具体变更请求**
```
“我需要对设计进行以下具体变更：
1. 将 Redis 缓存替换为内存缓存，以降低基础设施复杂性
2. 添加速率限制以防止暴力攻击（需求 1.4）
3. 为移动应用用例添加会话管理
4. 指定角色存储所需的数据库模式变更”
```

**解释原因**
```
“我想将认证方法从 OAuth 更改为 JWT，因为：
- 我们的团队在 JWT 实现方面有更多经验
- 它减少了外部依赖（不需要 OAuth 提供商）
- 更适合我们具有离线功能的移动应用需求
- 在我们当前的设置中更容易测试和调试”
```

## 解决常见问题

### 当回应过于笼统时

**问题：** AI 提供高级、笼统的建议，而不是具体的指导。

**解决方案：** 添加更多上下文和约束。

**之前：**
```
“我应该如何为用户管理构建我的数据库？”
```

**之后：**
```
“我有一个用于多租户 SaaS 应用的 PostgreSQL 数据库，具有以下约束：
- 500 家企业，平均每家 8 个用户
- 需要跟踪用户角色、权限和活动
- 当前用户表有 id、email、created_at
- 必须与现有认证系统保持向后兼容
- 性能目标：用户查找低于 50 毫秒

我应该如何扩展模式以支持基于角色的访问控制？”
```

### 当需求不断变化时

**问题：** 需求阶段出现范围蔓延。

**解决方案：** 建立明确的边界和优先级。

**方法：**
```
“让我们首先确定 MVP 范围。对于版本 1，我们必须具备：
- [核心需求 1]
- [核心需求 2]
- [核心需求 3]

未来版本的‘锦上添花’功能：
- [增强功能 1]
- [增强功能 2]

请仅将需求集中在 MVP 范围上。”
```

### 当设计变得过于复杂时

**问题：** 设计试图解决所有可能的未来需求。

**解决方案：** 重新关注当前的需求和约束。

**方法：**
```
“设计变得越来越复杂。让我们通过仅关注
需求 1.1-1.4 来简化它。我们可以在以后为需求
2.x 进行扩展。请修改设计以：
- 处理当前用户负载（而不是未来 10 倍的增长）
- 使用我们现有的技术栈（不要引入新技术）
- 解决我们需求中的具体问题（而不是一般性问题）”
```

### 当任务过于抽象时

**问题：** 实施任务对于实际编码来说过于高级。

**解决方案：** 请求具体的、可操作的编码步骤。

**之前：**
```
“- 实现用户认证系统”
```

**之后：**
```
“请将‘实现用户认证系统’分解为具体的编码任务，例如：
- 创建具有 email、password_hash、role 字段的 User 模型
- 使用 bcrypt 编写密码哈希工具函数
- 实现验证凭据并返回 JWT 的登录端点
- 创建中间件以验证受保护路由上的 JWT 令牌
- 为每个组件编写单元测试”
```

## 质量验证技术

### 需求验证

**完整性检查：**
```
“请审查这些需求并找出任何差距：
- 是否涵盖了所有用户类型？
- 我们是否处理了所有错误场景？
- 是否指定了集成点？
- 性能要求是否可衡量？
- 范围是否明确界定？”
```

**EARS 格式验证：**
```
“请检查这些验收标准是否正确遵循 EARS 格式：
- 它们是否以 WHEN、IF、WHERE、WHILE 开头？
- 系统响应是否用 SHALL 明确指定？
- 条件和触发器是否具体且可测试？”
```

### 设计验证

**架构审查：**
```
“请根据我们的需求验证此设计：
- 它是否解决了所有功能性需求？
- 是否处理了非功能性需求（性能、安全）？
- 组件之间的接口是否定义良好？
- 错误处理是否全面？
- 这是否可以有效测试？”
```

**技术可行性：**
```
“考虑到我们的约束（团队规模、时间表、现有系统），
这个设计是否现实？是否有任何部分看起来
过度设计或规范不足？”
```

### 任务验证

**可操作性检查：**
```
“这些任务对于开发人员来说是否足够具体以进行实施？
- 它们是否指定了要创建的确切文件/组件？
- 任务之间的依赖关系是否清晰？
- 每个任务是否可以独立完成和测试？
- 它们是否逐步构建以实现完整功能？”
```

## 高级技巧

### 研究整合

**当您需要技术研究时：**
```
“在我们最终确定设计之前，我需要研究多租户 SaaS 应用程序的认证
最佳实践。请帮助我确定要研究的关键领域：
- 基于角色的访问控制的行业标准
- 常见的安全漏洞和缓解措施
- JWT 在规模化应用中的性能优化技术
- 与现有系统的集成模式”
```

### 约束管理

**处理冲突的需求：**
```
“我们有冲突的需求：用户想要单点登录（需求 1.3），
但我们还需要离线功能（需求 2.1）。请帮助我：
1. 分析这些方法之间的权衡
2. 提出折衷解决方案
3. 建议哪个需求应优先考虑及其原因”
```

### 利益相关者对齐

**多角度验证：**
```
“请从不同利益相关者的角度审查这些需求：
- 开发人员：它们在我们的技术栈中是否技术上可行？
- 用户：它们是否有效地解决了真实的用户问题？
- 业务：它们是否与我们的业务目标和约束保持一致？
- 安全：是否存在任何安全问题或差距？”
```

---

[← 模板](templates.md) | [返回提示指南](README.md)